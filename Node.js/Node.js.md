# Node.js

### 模块的加载机制

- 内置模块的优先级最高。
- 模块加载后会进行缓存，重复的加载不会生效，会直接使用缓存。
- 模块路径中没有路径标识符时，会作为内置模块 / 第三方模块进行加载
- 加载自定义模块时，必须指定以 ./ 或 ../ 开头的路径标识符

使用 require() 导入自定义模块时，如果省略了文件的扩展名，则 Node.js 会按顺序分别尝试加载以下的文件：

1. 按照确切的文件名进行加载
2. 补全 .js 扩展名进行加载
3. 补全 .json 扩展名进行加载
4. 补全 .node 扩展名进行加载
5. 加载失败，终端报错

### 第三方模块的加载机制

传递给 require() 模块标识符不是一个内置模块，也没有以‘./’ 或 ‘../’ 开头，

- 则 Node.js 会从当前模块的父目录开始，从 /node_modules 文件夹中加载第三方模块。
- 如果没有找到对应的第三方模块，则移动到再上一层父目录中，进行加载
- 直到文件系统的根目录。

### 目录作为模块

将目录作为模块标识符。传递给 `require()` 进行加载的时候：

- 在被加载的目录下查找一个叫做 `package.json` 的文件，并寻找 `main` 属性，作为 require() 加载的入口
- 如果目录里面没有 `package.json`， 或者 `main` 入口不存在 / 无法解析，则 Node.js 会试图加载目录下的 `index.js` 文件
- 如果以上两步都失败，则在终端打印错误消息，报告模块缺失。`Error: Cannot find module 'xxx'`